<!--<div class="secondary">-->

<!--    <h2>Sidebar</h2>-->

<!--    <% console.log(sidebarData) %>-->

<!--    <% categories.forEach(function(cat) { %>-->
<!--        <div>-->
<!--            <li>-->
<!--                <a href="/cat/<%=cat.slug%>"><%=cat.name%></a>-->
<!--            </li>-->
<!--        </div>-->
<!--    <% }); %>-->
<!--</div>-->


<div class="secondary">
    <h1>All Categories</h1>
    <div id="sidebar_root"></div>
</div>

<script>

window.addEventListener("DOMContentLoaded", function (e){
	fetch("/api/sidebar_data", {
		method: "POST",
        body: JSON.stringify({})
      // body: JSON.stringify({
      //     category_slug: "HTML"
      //   })
    }).then(res=> res.json())
  .then(data=>{
		console.log(data.sidebarData)

  	let sidebar_root = document.querySelector("#sidebar_root")
		sidebar_root.innerHTML = null
		Object.keys(data.sidebarData).forEach(item=>{
          sidebar_root.innerHTML += `
			<div>
              <h2>${item}</h2>
              <div>
                ${data.sidebarData[item] && data.sidebarData[item].map(post=>{
                    return `<a href="${post.category_slug}/${post.slug}">${post.title}</a>`
				})}
</div>

	</div>
					`

        })

		console.log(data)
  })
})


</script>